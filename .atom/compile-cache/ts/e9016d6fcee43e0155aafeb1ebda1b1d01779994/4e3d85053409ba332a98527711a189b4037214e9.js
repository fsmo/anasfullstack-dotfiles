////////////////////////////////// MAGIC
var vm = require('vm');
var fs = require('fs');
global.stack = function () {
    console.error((new Error()).stack);
};
/** Makes the bundled typescript services global or (if passed in) a custom typescriptServices file */
function makeTsGlobal(typescriptServices) {
    var sandbox = {
        // This is going to gather the ts module exports
        ts: {},
        console: console,
        stack: global.stack,
        require: require,
        module: module,
        process: process
    };
    vm.createContext(sandbox);
    if (typescriptServices) {
        vm.runInContext(fs.readFileSync(typescriptServices).toString(), sandbox);
    }
    else {
        sandbox.ts = require('ntypescript');
    }
    // Finally export ts to the local global namespace
    global.ts = sandbox.ts;
}
exports.makeTsGlobal = makeTsGlobal;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2FuYXMvLmF0b20vcGFja2FnZXMvYXRvbS10eXBlc2NyaXB0L2xpYi90eXBlc2NyaXB0L21ha2VUeXBlU2NyaXB0R2xvYmFsLnRzIiwic291cmNlcyI6WyIvVXNlcnMvYW5hcy8uYXRvbS9wYWNrYWdlcy9hdG9tLXR5cGVzY3JpcHQvbGliL3R5cGVzY3JpcHQvbWFrZVR5cGVTY3JpcHRHbG9iYWwudHMiXSwibmFtZXMiOlsibWFrZVRzR2xvYmFsIl0sIm1hcHBpbmdzIjoiQUFDQSxBQURBLHdDQUF3QztBQUN4QyxJQUFPLEVBQUUsV0FBVyxJQUFJLENBQUMsQ0FBQztBQUMxQixJQUFPLEVBQUUsV0FBVyxJQUFJLENBQUMsQ0FBQztBQUkxQixNQUFNLENBQUMsS0FBSyxHQUFHO0lBQ1gsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFNLElBQUksS0FBSyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUM1QyxDQUFDLENBQUE7QUFHRCxBQURBLHNHQUFzRztTQUN0RixZQUFZLENBQUMsa0JBQTJCO0lBQ3BEQSxJQUFJQSxPQUFPQSxHQUFHQTtRQUVWQSxBQURBQSxnREFBZ0RBO1FBQ2hEQSxFQUFFQSxFQUFFQSxFQUFFQTtRQUNOQSxPQUFPQSxFQUFFQSxPQUFPQTtRQUNoQkEsS0FBS0EsRUFBRUEsTUFBTUEsQ0FBQ0EsS0FBS0E7UUFDbkJBLE9BQU9BLEVBQUVBLE9BQU9BO1FBQ2hCQSxNQUFNQSxFQUFFQSxNQUFNQTtRQUNkQSxPQUFPQSxFQUFFQSxPQUFPQTtLQUNuQkEsQ0FBQ0E7SUFDRkEsRUFBRUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0E7SUFFMUJBLEVBQUVBLENBQUNBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDckJBLEVBQUVBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLFlBQVlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsQ0FBQ0EsUUFBUUEsRUFBRUEsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7SUFDN0VBLENBQUNBO0lBQ0RBLElBQUlBLENBQUNBLENBQUNBO1FBQ0ZBLE9BQU9BLENBQUNBLEVBQUVBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBLENBQUNBO0lBQ3hDQSxDQUFDQTtJQUdEQSxBQURBQSxrREFBa0RBO0lBQ2xEQSxNQUFNQSxDQUFDQSxFQUFFQSxHQUFHQSxPQUFPQSxDQUFDQSxFQUFFQSxDQUFDQTtBQUMzQkEsQ0FBQ0E7QUFyQmUsb0JBQVksR0FBWixZQXFCZixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBNQUdJQ1xuaW1wb3J0IHZtID0gcmVxdWlyZSgndm0nKTtcbmltcG9ydCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5pbXBvcnQgb3MgPSByZXF1aXJlKCdvcycpO1xuaW1wb3J0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5cbmdsb2JhbC5zdGFjayA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnNvbGUuZXJyb3IoKDxhbnk+bmV3IEVycm9yKCkpLnN0YWNrKTtcbn1cblxuLyoqIE1ha2VzIHRoZSBidW5kbGVkIHR5cGVzY3JpcHQgc2VydmljZXMgZ2xvYmFsIG9yIChpZiBwYXNzZWQgaW4pIGEgY3VzdG9tIHR5cGVzY3JpcHRTZXJ2aWNlcyBmaWxlICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZVRzR2xvYmFsKHR5cGVzY3JpcHRTZXJ2aWNlcz86IHN0cmluZykge1xuICAgIHZhciBzYW5kYm94ID0ge1xuICAgICAgICAvLyBUaGlzIGlzIGdvaW5nIHRvIGdhdGhlciB0aGUgdHMgbW9kdWxlIGV4cG9ydHNcbiAgICAgICAgdHM6IHt9LFxuICAgICAgICBjb25zb2xlOiBjb25zb2xlLFxuICAgICAgICBzdGFjazogZ2xvYmFsLnN0YWNrLFxuICAgICAgICByZXF1aXJlOiByZXF1aXJlLFxuICAgICAgICBtb2R1bGU6IG1vZHVsZSxcbiAgICAgICAgcHJvY2VzczogcHJvY2Vzc1xuICAgIH07XG4gICAgdm0uY3JlYXRlQ29udGV4dChzYW5kYm94KTtcblxuICAgIGlmICh0eXBlc2NyaXB0U2VydmljZXMpIHtcbiAgICAgICAgdm0ucnVuSW5Db250ZXh0KGZzLnJlYWRGaWxlU3luYyh0eXBlc2NyaXB0U2VydmljZXMpLnRvU3RyaW5nKCksIHNhbmRib3gpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2FuZGJveC50cyA9IHJlcXVpcmUoJ250eXBlc2NyaXB0Jyk7XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSBleHBvcnQgdHMgdG8gdGhlIGxvY2FsIGdsb2JhbCBuYW1lc3BhY2VcbiAgICBnbG9iYWwudHMgPSBzYW5kYm94LnRzO1xufVxuIl19
//# sourceURL=/Users/anas/.atom/packages/atom-typescript/lib/typescript/makeTypeScriptGlobal.ts

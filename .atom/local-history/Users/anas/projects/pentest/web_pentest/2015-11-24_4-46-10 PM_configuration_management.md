### Test Network/Infrastructure Configuration (OTG-CONFIG-001)

  - #### The following steps need to be taken to test the configuration management infrastructure:
    - The different elements that make up the infrastructure need to be determined in order to understand how they interact with a web application and how they affect its security.
    - All the elements of the infrastructure need to be reviewed in order to make sure that they donâ€™t contain any known vulnerabilities.
    - A review needs to be made of the administrative tools used to maintain all the different elements.
    - The authentication systems, need to reviewed in order to assure that they serve the needs of the application and that they cannot be manipulated by external users to leverage access.
    - A list of defined ports which are required for the application should be maintained and kept under change control.
  - #### How to Test
    - Known Server Vulnerabilities
    > Some automated tools will flag vulnerabilities based on the web server version retrieved. This leads to both false positives and false negatives. On one hand, if the web server version has been removed or obscured by the local site administrator the scan tool will not  flag the server as vulnerable even if it is.

    - Administrative tools
      - Determine the mechanisms that control access to these interfaces and their associated susceptibilities. This information may be available online.
      - Change the default username and password.

### Test Application Platform Configuration (OTG-CONFIG-002)

  - #### How to Test
    - Black Box Testing
      - Sample and known files and directories
      - Code Comments review
    - Gray Box Testing
      - Configuration review
        - It is impossible to generically say how a server should be configured, however, some common guidelines should be taken into account:
          - Only enable server modules (ISAPI extensions in the case of IIS) that are needed for the application.
          - Handle server errors (40x or 50x) with custom-made pages instead of with the default web server pages.
          - Make sure that the server software runs with minimized privileges in the operating system.
          - Make sure the server software properly logs both legitimate access and errors.
          - Make sure that the server is configured to properly handle overloads and prevent Denial of Service attacks.
          - Never grant non-administrative identities (with the exception of NT SERVICE\WMSvc) access to applicationHost.config, redirection. config, and administration.config (either Read or Write access). This includes Network Service, IIS_IUSRS, IUSR, or any custom identity used by IIS application pools. IIS worker processes are not meant to access any of these files directly.
          -  Never share out applicationHost.config, redirection.config, and administration.config on the network.
          - Keep in mind that all users can read .NET Framework machine.config and root web.config files by default. Do not store sensitive information in these files if it should be for administrator eyes only.
          - Encrypt sensitive information that should be read by the IIS worker processes only and not by other users on the machine.
          - Do not grant Write access to the identity that the Web server uses to access the shared applicationHost.config. This identity should have only Read access.
          - Use a separate identity to publish applicationHost.config to the share. Do not use this identity for configuring access to the shared configuration on the Web servers.
          - Use a strong password when exporting the encryption keys for use with shared -configuration.
          - Maintain restricted access to the share containing the shared configuration and encryption keys. If this share is compromised, an attacker will be able to read and write any IIS configuration for your Web servers, redirect traffic from your Web site to malicious sources, and in some cases gain control of all web servers by loading arbitrary code into IIS worker processes.
          - Consider protecting this share with firewall rules and IPsec policies to allow only the member web servers to connect.
      - Logging
        - In both cases (server and application logs) several issues should be tested and analysed based on the log contents:
          - Do the logs contain sensitive information?
          - Are the logs stored in a dedicated server?
          - Can log usage generate a Denial of Service condition?
          - How are they rotated? Are logs kept for the sufficient time?
          - How are logs reviewed? Can administrators use these reviews to detect targeted attacks?
          - How are log backups preserved?
          - Is the data being logged data validated (min/max length, chars etc) prior to being logged?
      - Sensitive information in logs
      - 

### Test Network/Infrastructure Configuration (OTG-CONFIG-001)

  - #### The following steps need to be taken to test the configuration management infrastructure:
    - The different elements that make up the infrastructure need to be determined in order to understand how they interact with a web application and how they affect its security.
    - All the elements of the infrastructure need to be reviewed in order to make sure that they don’t contain any known vulnerabilities.
    - A review needs to be made of the administrative tools used to maintain all the different elements.
    - The authentication systems, need to reviewed in order to assure that they serve the needs of the application and that they cannot be manipulated by external users to leverage access.
    - A list of defined ports which are required for the application should be maintained and kept under change control.
  - #### How to Test
    - Known Server Vulnerabilities
    > Some automated tools will flag vulnerabilities based on the web server version retrieved. This leads to both false positives and false negatives. On one hand, if the web server version has been removed or obscured by the local site administrator the scan tool will not  flag the server as vulnerable even if it is.

    - Administrative tools
      - Determine the mechanisms that control access to these interfaces and their associated susceptibilities. This information may be available online.
      - Change the default username and password.

### Test Application Platform Configuration (OTG-CONFIG-002)

  - #### How to Test
    - Black Box Testing
      - Sample and known files and directories
      - Code Comments review
    - Gray Box Testing
      - Configuration review
        - It is impossible to generically say how a server should be configured, however, some common guidelines should be taken into account:
          - Only enable server modules (ISAPI extensions in the case of IIS) that are needed for the application.
          - Handle server errors (40x or 50x) with custom-made pages instead of with the default web server pages.
          - Make sure that the server software runs with minimized privileges in the operating system.
          - Make sure the server software properly logs both legitimate access and errors.
          - Make sure that the server is configured to properly handle overloads and prevent Denial of Service attacks.
          - Never grant non-administrative identities (with the exception of NT SERVICE\WMSvc) access to applicationHost.config, redirection. config, and administration.config (either Read or Write access). This includes Network Service, IIS_IUSRS, IUSR, or any custom identity used by IIS application pools. IIS worker processes are not meant to access any of these files directly.
          -  Never share out applicationHost.config, redirection.config, and administration.config on the network.
          - Keep in mind that all users can read .NET Framework machine.config and root web.config files by default. Do not store sensitive information in these files if it should be for administrator eyes only.
          - Encrypt sensitive information that should be read by the IIS worker processes only and not by other users on the machine.
          - Do not grant Write access to the identity that the Web server uses to access the shared applicationHost.config. This identity should have only Read access.
          - Use a separate identity to publish applicationHost.config to the share. Do not use this identity for configuring access to the shared configuration on the Web servers.
          - Use a strong password when exporting the encryption keys for use with shared -configuration.
          - Maintain restricted access to the share containing the shared configuration and encryption keys. If this share is compromised, an attacker will be able to read and write any IIS configuration for your Web servers, redirect traffic from your Web site to malicious sources, and in some cases gain control of all web servers by loading arbitrary code into IIS worker processes.
          - Consider protecting this share with firewall rules and IPsec policies to allow only the member web servers to connect.
      - Logging
        - In both cases (server and application logs) several issues should be tested and analysed based on the log contents:
          - Do the logs contain sensitive information?
          - Are the logs stored in a dedicated server?
          - Can log usage generate a Denial of Service condition?
          - How are they rotated? Are logs kept for the sufficient time?
          - How are logs reviewed? Can administrators use these reviews to detect targeted attacks?
          - How are log backups preserved?
          - Is the data being logged data validated (min/max length, chars etc) prior to being logged?
      - Sensitive information in logs
        - Event logs will often contain data that is useful to an attacker (information leakage) or can be used directly in exploits:
          - Debug information
          - Stack traces
          - Usernames
          - System component names
          - Internal IP addresses
          - Less sensitive personal data (e.g. email addresses, postal addresses and telephone numbers associated with named individuals)
          - Business data
          -  Application source code
          - Session identification values
          - Access tokens
          - Sensitive personal data and some forms of personal identifiable information (PII)
          - Authentication passwords
          - Database connection strings
          - Encryption keys
          - Bank account or payment card holder data
          - Data of a higher security classification than the logging system is allowed to store
          - Commercially-sensitive information
          - Information it is illegal to collect in the relevant jurisdiction
          - Information a user has opted out of collection, or not consented to e.g. use of do not track, or where consent to collect has expired
      - Log location
        - it is wiser to keep logs in a separate location and not in the web server itself.
      - Log storage
        - Logs can introduce a Denial of Service condition if they are not properly stored. Any attacker with sufficient resources could be able to produce a sufficient number of requests that would fill up the allocated space to log files, if they are not specifically prevented from doing so.
      - Log rotation
        - This feature should be tested in order to ensure that:
          - Logs are kept for the time defined in the security policy, not more and not less.
          - Logs are compressed once rotated (this is a convenience, since it will mean that more logs will be stored for the same available disk space).
          - File system permission of rotated log files are the same (or stricter) that those of the log files itself. For example, web servers will need to write to the logs they use but they don’t actually need to write to rotated logs, which means that the permissions of the files can be changed upon rotation to prevent the web server process from modifying these
          - Some servers might rotate logs when they reach a given size. If this happens, it must be ensured that an attacker cannot force logs to rotate in order to hide his tracks.
      - Log Access Control
        - Event log information should never be visible to end users. Even web administrators should not be able to see such logs since it breaks separation of duty controls.
      - Log review
        - Review of logs can be used for more than extraction of usage statistics of files in the web servers (which is typically what most log-based application will focus on), but also to determine if attacks take place at the web server.
        - In order to analyze web server attacks the error log files of the server need to be analyzed. Review should concentrate on:
          - 40x (not found) error messages. A large amount of these from the same source might be indicative of a CGI scanner tool being used against the web server
          - 50x (server error) messages. These can be an indication of an attacker abusing parts of the application which fail unexpectedly. For example, the first phases of a SQL injection attack will produce these error message when the SQL query is not properly constructed and its execution fails on the back end database. Log statistics or analysis should not be generated, nor stored, in the same server that produces the logs.

### Test File Extensions Handling for Sensitive Information (OTG-CONFIG-003)

  - Determining how web servers handle requests corresponding to files having different extensions may help in understanding web server behavior depending on the kind of files that are accessed.
  -
